<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=720">
<title>ABS.Stat Natural Language Processing Tool</title>

<style>
body {
       background: #555 url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAB9JREFUeNpi/P//PwM6YGLAAuCCmpqacC2MRGsHCDAA+fIHfeQbO8kAAAAASUVORK5CYII=);
        font: 13px 'Lucida sans', Arial, Helvetica;
        color: #eee;
        text-align: center;
}

a {
	color: #383838;
 }

a:visited {
    color: #383838;
}

 .cf:before, .cf:after{
 	content:"";
    display:table;
 }
    
	.cf:after{
 	clear:both;
 }

.cf{
 	zoom:1;
 }

 .form-wrapper {
 	width: 500px;
    padding: 15px;
    margin: 150px auto 50px auto;
    background: #888;
    background: rgba(0,0,0,.2);
    -moz-border-radius: 10px;
    -webkit-border-radius: 10px;
    border-radius: 10px;
    -moz-box-shadow: 0 1px 1px rgba(0,0,0,.4) inset, 0 1px 0 rgba(255,255,255,.2);
    -webkit-box-shadow: 0 1px 1px rgba(0,0,0,.4) inset, 0 1px 0 rgba(255,255,255,.2);
    box-shadow: 0 1px 1px rgba(0,0,0,.4) inset, 0 1px 0 rgba(255,255,255,.2);
 }
    
    .form-wrapper input {
        width: 370px;
        height: 20px;
        padding: 10px;
        float: left;    
        font: bold 15px 'lucida sans', 'trebuchet MS', 'Tahoma';
        border: 0;
        background: #eee;
        -moz-border-radius: 3px 0 0 3px;
        -webkit-border-radius: 3px 0 0 3px;
        border-radius: 3px 0 0 3px;      
    }
    
    .form-wrapper input:focus {
        outline: 0;
        background: #fff;
        -moz-box-shadow: 0 0 2px rgba(0,0,0,.8) inset;
        -webkit-box-shadow: 0 0 2px rgba(0,0,0,.8) inset;
        box-shadow: 0 0 2px rgba(0,0,0,.8) inset;
    }
    
    .form-wrapper input::-webkit-input-placeholder {
       color: #999;
       font-weight: normal;
       font-style: italic;
    }
    
    .form-wrapper input:-moz-placeholder {
        color: #999;
        font-weight: normal;
        font-style: italic;
    }
    
    .form-wrapper input:-ms-input-placeholder {
        color: #999;
        font-weight: normal;
        font-style: italic;
    }    
    
    .form-wrapper button {
		overflow: visible;
        position: relative;
        float: right;
        border: 0;
        padding: 0;
        cursor: pointer;
        height: 40px;
        width: 110px;
        font: bold 15px/40px 'lucida sans', 'trebuchet MS', 'Tahoma';
        color: #fff;
        text-transform: uppercase;
        background: #206020;
        -moz-border-radius: 0 3px 3px 0;
        -webkit-border-radius: 0 3px 3px 0;
        border-radius: 0 3px 3px 0;      
        text-shadow: 0 -1px 0 rgba(0, 0 ,0, .3);
    }   
      
    .form-wrapper button:hover{		
        background: #308030;
    }	
      
    .form-wrapper button:active,
    .form-wrapper button:focus{   
        background: #308030;    
    }
    
    .form-wrapper button:before {
        content: '';
        position: absolute;
        border-width: 8px 8px 8px 0;
        border-style: solid solid solid none;
        border-color: transparent #206020 transparent;
        top: 12px;
        left: -6px;
    }
    
    .form-wrapper button:hover:before{
        border-right-color: #308030;
    }
    
    .form-wrapper button:focus:before{
        border-right-color: #308030;
    }    
    
    .form-wrapper button::-moz-focus-inner {
        border: 0;
        padding: 0;
    }
        
#output {
	margin-left: 10px;
	margin-top:50px;
	background: #308030;
    font: 15px 'lucida sans', 'trebuchet MS', 'Tahoma';
	border: none;
    border-radius: 6px;
    -webkit-border-radius: 6px;
    -moz-border-radius: 6px;
    text-align:left;
	color: #383838;
}

#result {
	color: #fff;
	font-weight: normal;
	font-size: 3em;
	line-height: 2.0;
	margin-right:130px;
}


#datasetURL {
	line-height: 2.0;
	font-size:1.5em;
}

#map {
	line-height: 1.0;
}

#url {
	line-height: 1.5;
}

#poweredBY {
	line-height: 1.5;
	font-size:0.5em;
	text-align:right;
}

</style>

<script src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"
	type="text/javascript"></script>

<script>
	$(document).ready(function() {
		$("#query").keyup(function(event) {
			if (event.keyCode == 13) {
				$("#go").click();
			}
		});
		$('#go').click(function() {
			$('#result').text('searching...');
			var url = '/main/query/' + $('#query').val();
			$.getJSON(url, function(data, status, jqXHR) {
				$("#result").text(data.result.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ","));
				$("#url").html('<a href="'+data.url+'" target="_blank" >' + 'citation' + '</a><br>');
				$("#datasetURL").html('<a href="'+data.datasetURL+'" target="_blank" >' + data.datasetName + '</a><br>');
				$('#map').text(' ');
				$.each(data, function(index) {
					if (index != 'result' && index != 'url'&& index != 'datasetName' && index != 'datasetURL') {
						var e = data[index];

						/*TODO: Fix for age ranges*/
						if ($.isArray(e) && e.length > 1 && index == "Age") {
							var dataArray = [];
							for (year in e) {
								var word = e[year];
								dataArray.push(word);
							}
							e = dataArray.sort(function(a, b) {
								return a - b;
							});
							e = e[0] + ", ... , " + e[e.length - 1];
						}
						$("#map").append(index + " : " + e + '<br>');
					}
				});

			});
		});
	});
</script>

</head>
<body>

	<div class="form-wrapper cf">
		<input type="text" id="query" placeholder="eg. How many women in Tasmania are Buddhists?" required>
		<button type="submit" id="go" >Search</button>
		<div id="output">
			<div id="result"></div>
			<div id="datasetURL"></div>
			<div id="map"></div>
			<div id="url"></div>
			<div id="poweredBy">powered by ABS.Stat</div>
		</div>
	</div>
</body>
</html>
